(()=>{var Bt=Object.create;var st=Object.defineProperty;var Pt=Object.getOwnPropertyDescriptor;var Ot=Object.getOwnPropertyNames;var Gt=Object.getPrototypeOf,Nt=Object.prototype.hasOwnProperty;var K=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Lt=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ot(t))!Nt.call(e,n)&&n!==r&&st(e,n,{get:()=>t[n],enumerable:!(s=Pt(t,n))||s.enumerable});return e};var g=(e,t,r)=>(r=e!=null?Bt(Gt(e)):{},Lt(t||!e||!e.__esModule?st(r,"default",{value:e,enumerable:!0}):r,e));var E=K((be,it)=>{it.exports=wp.element});var A=K((ke,ct)=>{ct.exports=wp.data});var M=K((Te,ut)=>{ut.exports=wp.blockEditor});var vt=K((Gr,Mt)=>{Mt.exports=wp.preferences});var R=g(E());var Yt=g(A()),Wt=g(M()),kt=g(E());var w={attributes:{display:{css:"display",type:"string",group:"display"},visibility:{css:"visibility",type:"string",group:"display"},overflow:{css:"overflow",type:"string",group:"display"},width:{css:"width",type:"string",group:"dimension"},height:{css:"height",type:"string",group:"dimension"},maxWidth:{css:"max-width",type:"string",group:"dimension"},maxHeight:{css:"max-height",type:"string",group:"dimension"},minWidth:{css:"min-width",type:"string",group:"dimension"},minHeight:{css:"min-height",type:"string",group:"dimension"},marginTop:{css:"margin-top",type:"string",group:"margin"},marginRight:{css:"margin-right",type:"string",group:"margin"},marginBottom:{css:"margin-bottom",type:"string",group:"margin"},marginLeft:{css:"margin-left",type:"string",group:"margin"},paddingTop:{css:"padding-top",type:"string",group:"padding"},paddingRight:{css:"padding-right",type:"string",group:"padding"},paddingBottom:{css:"padding-bottom",type:"string",group:"padding"},paddingLeft:{css:"padding-left",type:"string",group:"padding"},flexDirection:{css:"flex-direction",type:"string",group:"flex"},flexWrap:{css:"flex-wrap",type:"string",group:"flex"},justifyContent:{css:"justify-content",type:"string",group:"flex"},alignItems:{css:"align-items",type:"string",group:"flex"},alignContent:{css:"align-content",type:"string",group:"flex"},flexGrow:{css:"flex-grow",type:"number",group:"flex-item"},flexShrink:{css:"flex-shrink",type:"number",group:"flex-item"},flexBasis:{css:"flex-basis",type:"string",group:"flex-item"},gridTemplateColumns:{css:"grid-template-columns",type:"string",group:"grid"},gridTemplateRows:{css:"grid-template-rows",type:"string",group:"grid"},gridTemplateAreas:{css:"grid-template-areas",type:"string",group:"grid"},gridColumn:{css:"grid-column",type:"string",group:"grid-item",default:""},gridRow:{css:"grid-row",type:"string",group:"grid-item",default:""},gridArea:{css:"grid-area",type:"string",group:"grid-item",default:""},gap:{css:"gap",type:"string",group:"shared"},order:{css:"order",type:"number",group:"shared"},alignSelf:{css:"align-self",type:"string",group:"shared"},justifySelf:{css:"justify-self",type:"string",group:"shared"},position:{css:"position",type:"string",group:"position"},top:{css:"top",type:"string",group:"position"},right:{css:"right",type:"string",group:"position"},bottom:{css:"bottom",type:"string",group:"position"},left:{css:"left",type:"string",group:"position"},inset:{css:"inset",type:"string",group:"position"},zIndex:{css:"z-index",type:"number",group:"position"}},collections:{unitless:["flexGrow","flexShrink","order","zIndex"],editorStyles:["core/paragraph","core/heading","core/list","core/quote","core/pullquote","core/table"],clearSets:{gridAreas:["gridAreas"],gridColumns:["gridColumn","gridColumnStart","gridColumnEnd"],gridRows:["gridRow","gridRowStart","gridRowEnd"]}},settings:{gridUnit:"1fr",appendImportantToMirroredStyles:!0,styleTagId:"costered-blocks-style-mirror",reduxStoreKey:"costered/ui",breakpoints:{mobile:782,tablet:1024,desktop:1440}}};var at=e=>Array.isArray(e)?e:[],Ut=e=>new Set(at(e));function _(e){return Object.fromEntries(Object.entries(w.attributes).filter(([t,r])=>r.group===e))}var pt=_("display"),lt=_("dimension"),dt=_("margin"),mt=_("padding"),ft=_("flex"),gt=_("flex-item"),yt=_("grid"),z=_("grid-item"),xt=_("position"),St=_("shared"),Ae={...pt,...lt,...dt,...mt,...ft,...gt,...yt,...z,...xt,...St},ht=new Set([...Object.keys(z)]),Re=at(w?.collections?.editorStyles),bt=Ut(w?.collections?.unitless),X=w?.settings?.gridUnit||"1fr",Ie=!!w?.settings?.appendImportantToMirroredStyles,_e=w?.settings?.styleTagId||"costered-blocks-style-mirror",V=w?.settings?.reduxStoreKey||"costered/ui",Ce=w?.settings?.breakpoints?.mobile??782,Me=w?.settings?.breakpoints?.tablet??1024,ve=w?.settings?.breakpoints?.desktop??1440,De=w?.collections?.clearSets?.gridAreas,$e=w?.collections?.clearSets?.gridColumns,Be=w?.collections?.clearSets?.gridRows;var Ht=new Set([...Object.keys(pt),...Object.keys(lt),...Object.keys(mt),...Object.keys(dt),...Object.keys(ft),...Object.keys(gt),...Object.keys(yt),...Object.keys(z),...Object.keys(xt),...Object.keys(St)]),Pe=Object.fromEntries(Object.entries(w.attributes).map(([e,t])=>[e,t.css]));var v=e=>{let t={desktop:{styles:{}},tablet:{styles:{}},mobile:{styles:{}},...e||{}};return t.desktop={styles:{},...t.desktop||{}},t.tablet={styles:{},...t.tablet||{}},t.mobile={styles:{},...t.mobile||{}},t.desktop.styles={...t.desktop.styles||{}},t.tablet.styles={...t.tablet.styles||{}},t.mobile.styles={...t.mobile.styles||{}},t},q=(e,t,r)=>{r==null||r===""?Object.prototype.hasOwnProperty.call(e,t)&&delete e[t]:e[t]=r},Z=e=>e==null||e===""||e==="null"||e==="undefined";var Kt="desktop",Ft=Object.freeze({});function O(e,t){let r=e||Ft,s={...r},n=v(r.costered),a=m=>{switch(m){case"mobile":return["mobile","tablet","desktop"];case"tablet":return["tablet","desktop"];default:return["desktop"]}},u=(m,f=void 0)=>{let k=f&&Object.prototype.hasOwnProperty.call(f,"cascade")?!!f.cascade:!0,T=f&&Object.prototype.hasOwnProperty.call(f,"raw")?!!f.raw:!k,x=t||Kt;if(T){let S=n?.[x]?.styles?.[m];return Z(S)?void 0:S}let y=a(x);for(let S of y){let c=n?.[S]?.styles?.[m];if(!Z(c))return c}};return Object.defineProperties(s,{$get:{value:u,enumerable:!1},$getCascade:{value:m=>u(m,{cascade:!0}),enumerable:!1},$getMany:{value:(m,f)=>{let k={};for(let T of m)k[T]=u(T,f);return k},enumerable:!1},$bp:{value:t,enumerable:!1}}),s}var C=g(E()),$=g(A());var zt=e=>typeof e=="string"&&e.trim().length>0,Xt=()=>{if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")return crypto.randomUUID();let e=Date.now().toString(36),t=Math.random().toString(36).slice(2,10);return`${e}-${t}`},G=e=>{e&&!zt(e.costeredId)&&(e.costeredId=Xt())};var N=g(A());var Vt=e=>{let t=String(e||"").toLowerCase();return t==="mobile"||t==="phone"||t==="tablet"?"mobile":"desktop"},qt=e=>{try{let t=e("core/edit-post");if(t){if(typeof t.getPreviewDeviceType=="function")return t.getPreviewDeviceType();if(typeof t.__experimentalGetPreviewDeviceType=="function")return t.__experimentalGetPreviewDeviceType()}}catch{}try{let t=e("core/edit-site");if(t){if(typeof t.getDeviceType=="function")return t.getDeviceType();if(typeof t.__experimentalGetPreviewDeviceType=="function")return t.__experimentalGetPreviewDeviceType();if(typeof t.getPreviewDeviceType=="function")return t.getPreviewDeviceType()}}catch{}},D=e=>{try{let r=(0,N.select)(V);if(r&&typeof r.getBreakpoint=="function"){let s=r.getBreakpoint();if(s)return s}}catch{}let t=qt(e);if(t)return Vt(t);if(typeof window<"u"&&typeof window.__COSTERED_VIEWPORT_BP=="string")return window.__COSTERED_VIEWPORT_BP||"desktop";try{if(window.COSTERED_DEBUG){let r=(0,N.select)(STORE_KEY),s=r&&typeof r.getBreakpoint=="function"?r.getBreakpoint():null,n=(0,N.select)("core/edit-post"),a=n&&(typeof n.getPreviewDeviceType=="function"&&n.getPreviewDeviceType()||typeof n.__experimentalGetPreviewDeviceType=="function"&&n.__experimentalGetPreviewDeviceType()),u=(0,N.select)("core/edit-site"),o=u&&(typeof u.getDeviceType=="function"&&u.getDeviceType()||typeof u.__experimentalGetPreviewDeviceType=="function"&&u.__experimentalGetPreviewDeviceType()||typeof u.getPreviewDeviceType=="function"&&u.getPreviewDeviceType())}}catch{}return"desktop"};var Zt="desktop";function F(e,t,r={trim:!0,emptyUnsets:!0,breakpoint:void 0}){let{trim:s=!0,emptyUnsets:n=!0,breakpoint:a}=r,u=(0,$.useSelect)(D,[]),o=a||u||Zt,{updateBlockAttributes:d}=(0,$.useDispatch)("core/block-editor"),m=(0,C.useMemo)(()=>{if(typeof e=="string"&&!t){let c=e;return p=>{if(c)if(typeof p=="function"){let i=(0,$.select)("core/block-editor").getBlockAttributes(c)||{},l=p(i)||i;d(c,l)}else d(c,p||{})}}if(typeof e=="function"&&typeof t=="string"){let c=e,p=t;return i=>{if(p)if(typeof i=="function"){let l=(0,$.select)("core/block-editor").getBlockAttributes(p)||{},h=i(l)||l;try{c(p,h)}catch{c(h)}}else try{c(p,i||{})}catch{c(i||{})}}}return typeof e=="function"?e:()=>{}},[e,t,d]),f=(0,C.useCallback)((c,p)=>{if(c==null)return;if(ht.has(p)){let l=typeof c=="string"&&s?c.trim():String(c);return n&&l===""?void 0:l}let i=c;if(s&&typeof i=="string"&&(i=i.trim()),!(n&&(i===""||i=="null"||i=="undefined"))){if(bt.has(p)){if(typeof i=="string"&&/^-?\d+(\.\d+)?$/.test(i)){let l=Number(i);return Number.isFinite(l)?l:void 0}return typeof i=="number"&&Number.isFinite(i)?i:void 0}if(typeof i=="number")return Number.isFinite(i)?i:void 0;if(typeof i=="string")return i==="null"||i==="undefined"?void 0:i;try{return String(i)}catch{return}}},[s,n]),k=(0,C.useCallback)((c,p)=>{m(i=>{let l={...i||{}};G(l),l.costered=v(l.costered);let h={...l.costered[o].styles},I=f(p,c);return q(h,c,I),l.costered[o]={...l.costered[o],styles:h},l})},[m,o,f]),T=(0,C.useCallback)(c=>{!c||typeof c!="object"||m(p=>{let i={...p||{}};G(i),i.costered=v(i.costered);let l={...i.costered[o].styles};for(let[h,I]of Object.entries(c)){let H=f(I,h);q(l,h,H)}return i.costered[o]={...i.costered[o],styles:l},i})},[m,o,f]),x=(0,C.useCallback)(c=>{m(p=>{let i={...p||{}};G(i),i.costered=v(i.costered);let l={...i.costered[o].styles};return c in l?(delete l[c],i.costered[o]={...i.costered[o],styles:l},i):p})},[m,o]),y=(0,C.useCallback)(c=>{!Array.isArray(c)||c.length===0||m(p=>{let i={...p||{}};G(i),i.costered=v(i.costered);let l={...i.costered[o].styles},h=!1;for(let I of c)I in l&&(delete l[I],h=!0);return h?(i.costered[o]={...i.costered[o],styles:l},i):p})},[m,o]),S=(0,C.useCallback)(c=>({set:(p,i)=>k(`${c}${p}`,i),setMany:p=>{let i={};for(let[l,h]of Object.entries(p))i[`${c}${l}`]=h;T(i)},unset:p=>x(`${c}${p}`),unsetMany:p=>y(p.map(i=>`${c}${i}`))}),[k,T,x,y]);return{set:k,setMany:T,unset:x,unsetMany:y,withPrefix:S,activeBreakpoint:o}}var Y=g(E());var ur=Number.MAX_SAFE_INTEGER;var te=g(E());var et=g(A()),It=g(M()),rt=g(E());function Q(e){return String(e||"").replace(/\s+/g," ").replace(/\s*\(\s*/g,"(").replace(/\s*\)\s*/g,")").replace(/\s*,\s*/g,",").trim().toLowerCase()}function ee(e){let t=String(e||"").trim();if(!t)return[];let r=0,s=0,n="",a=[];for(let u=0;u<t.length;u++){let o=t[u];if(o==="("){r++,n+=o;continue}if(o===")"){r=Math.max(0,r-1),n+=o;continue}if(o==="["){s++,n+=o;continue}if(o==="]"){s=Math.max(0,s-1),n+=o;continue}if(o===" "&&r===0&&s===0){n&&(a.push(n),n="");continue}n+=o}return n&&a.push(n),a}function re(e){if(!e)return null;let t=e.match(/^repeat\(\s*(\d+)\s*,\s*([^)]+)\s*\)$/i);return t?{count:parseInt(t[1],10),unit:t[2].trim()}:null}function ne(e,t=X){return e>0?`repeat(${e}, ${t})`:null}function j(e,t=X){if(!e||typeof e!="string")return{count:0,unit:t};let r=e.trim();if(!r)return{count:0,unit:t};if(/^subgrid\b/i.test(r))return{count:0,unit:t};if(r=r.replace(/\[[^\]]*]/g," ").trim(),!r)return{count:0,unit:t};let s=r.match(/^\s*repeat\(\s*auto-(fill|fit)\s*,\s*(.+)\)\s*$/i);if(s){let u=s[2];return{count:0,unit:J(u,t)}}let{count:n,unit:a}=oe(r,t);return{count:n,unit:a||t}}function oe(e,t){let r=Tt(e);if(r){let o=r.inner.trim(),m=L(o).length,f=J(o,t);return{count:r.times*m,unit:f||t}}let s=L(e),n=0,a="";for(let o of s){if(/^\s*repeat\(/i.test(o)){let d=wt(o);if(d){n+=d.count,!a&&d.unitHint&&(a=d.unitHint);continue}n+=1;continue}n+=1,!a&&W(o)&&(a=B(o)||"")}let u=a||J(e,t);return{count:n,unit:u||t}}function Tt(e){let t=e.match(/^repeat\(\s*([0-9]+)\s*,\s*([\s\S]+)\)\s*$/i);if(!t)return null;let r=parseInt(t[1],10),s=t[2];return!Number.isFinite(r)||r<0?null:{times:r,inner:s}}function wt(e){if(e.match(/^\s*repeat\(\s*auto-(fit|fill)\s*,/i))return{count:0,unitHint:""};let r=e.match(/^\s*repeat\(\s*([0-9]+)\s*,\s*([\s\S]+)\)\s*$/i);if(!r)return null;let s=parseInt(r[1],10)||0;if(s<=0)return{count:0,unitHint:""};let n=r[2].trim(),a=L(n),u=s*a.length,o="";if(a.length===1)o=B(a[0])||"";else{let d=a.find(W);o=B(d)||""}return{count:u,unitHint:o}}function L(e){let t=[],r=0,s="";for(let n=0;n<e.length;n++){let a=e[n];if(a==="("){r++,s+=a;continue}if(a===")"){r=Math.max(0,r-1),s+=a;continue}if(r===0&&/\s/.test(a)){s.trim()&&t.push(s.trim()),s="";continue}s+=a}return s.trim()&&t.push(s.trim()),t}function J(e,t){if(!e)return t;let r=Tt(e);if(r){let a=L(r.inner);if(a.length===1)return B(a[0])||t;let u=a.find(W);if(u)return B(u)||t}let s=L(e);if(s.length===1)return B(s[0])||t;let n=s.find(W);if(n)return B(n)||t;for(let a of s){let u=wt(a);if(u&&u.unitHint)return u.unitHint}return t}function W(e){return e?!!(/^(minmax|fit-content|clamp|var)\(/i.test(e)||/^[0-9.]+(px|rem|em|ch|vh|vw|vmin|vmax|fr|%)$/i.test(e)||/^(auto|max-content|min-content)$/i.test(e)):!1}function B(e){return e?e.trim():""}function b(e){let t=Number(e);return Number.isFinite(t)&&t>=0?Math.floor(t):0}function Et(e){let t=String(e||"").trim();if(!t)return{hasAreas:!1,cols:0,rows:0};let r=[],s=/"([^"]*)"|'([^']*)'/g,n;for(;n=s.exec(t);){let u=(n[1]??n[2]??"").trim();u&&r.push(u)}return r.length?{hasAreas:!0,cols:r.reduce((u,o)=>{let d=o.split(/\s+/).filter(Boolean).length;return Math.max(u,d)},0),rows:r.length}:{hasAreas:!1,cols:0,rows:0}}function At(e,t="."){if(!Array.isArray(e)||e.length===0)return"";let r=e.map(n=>(Array.isArray(n)?n:[]).map(a=>{let u=String(a??"").trim();return u===""?t:u}));return r.some(n=>n.some(a=>a!==t))?r.map(n=>`"${n.join(" ")}"`).join(" "):""}function Rt(e,t="."){let r=String(e||"").trim();if(!r)return[];let s=[],n=/"([^"]*)"|'([^']*)'/g,a;for(;a=n.exec(r);){let u=(a[1]??a[2]??"").trim(),o=u.length?u.split(/\s+/g).map(d=>d&&d!==t?d:t):[];s.push(o)}return s}function U(e,t,r,s="."){let n=b(t),a=b(r);if(n===0||a===0)return[];let u=Array.isArray(e)?e:[],o=[];for(let d=0;d<a;d++){let m=Array.isArray(u[d])?u[d]:[],f=Array.from({length:n},(k,T)=>{let x=m[T];return x===void 0?s:x});o.push(f)}return o}function se(e){let t=re(e);if(!t)return null;let r=Q(ne(t.count,t.unit));return{mode:"simple",template:e||null,normalised:r,simple:{count:t.count,unit:t.unit}}}function ie(e){let t=ee(e);if(!t.length)return null;let r=Q(t.join(" "));return{mode:"tracks",template:e||null,normalised:r,tracks:t}}var ce=[se,ie];function tt(e){let t=e||"";for(let r of ce){let s=r(t);if(s)return s}return{mode:"raw",template:e||null,normalised:Q(e||"")}}function nt(e){let t=(0,et.useSelect)(u=>e?u(It.store).getBlock(e)?.attributes??{}:{},[e]),r=(0,et.useSelect)(D,[]),s=(0,rt.useMemo)(()=>O(t,r),[t,r]),n=(u,o={})=>s.$get(u,o);return(0,rt.useMemo)(()=>{let u=n("gridTemplateColumns"),o=n("gridTemplateRows"),d=n("gridTemplateAreas"),m=tt(u),f=tt(o),{template:k,...T}=Et(d,m.count,f.count);return{columns:m,rows:f,areas:{template:k,...T},activePane:{columns:m.mode,rows:f.mode}}},[r,s?.costered,s?.$get])}var P=g(E()),_t=g(A()),Ct=g(M());function ot(e){let{set:t,unset:r}=F(e),s=(0,_t.useSelect)(x=>x(Ct.store).getBlock(e)?.innerBlocks?.length||0,[e]),n=nt(e),a=n?.columns?.template??null,u=n?.rows?.template??null,o=n?.areas?.template??null,d=(0,P.useMemo)(()=>{if(a){let y=j(a),S=b(y?.count??y);if(S>0)return S}let x=b(n?.rows?.count)||(()=>{if(!u)return 0;let y=j(u);return b(y?.count??y)})();return x>0&&s>0?Math.ceil(s/x):0},[a]),m=(0,P.useMemo)(()=>{let x=b(n?.rows?.count);if(x>0)return x;if(u){let S=j(u),c=b(S?.count??S);if(c>0)return c}let y=b(d);return y>0&&s>0?Math.ceil(s/y):0},[u,n?.rows?.count]),f=(0,P.useCallback)(x=>{let y=At(x,".");console.log("[areas write]",y),y?t("gridTemplateAreas",y):r("gridTemplateAreas")},[t,r]),k=(0,P.useCallback)(()=>{r("gridTemplateAreas")},[r]),T=(0,P.useCallback)((x=".")=>{let y=Rt(o,x),S=b(y[0]?.length)||b(d),c=b(y.length)||b(m);return S===0&&c>0&&s>0?S=Math.ceil(s/c):c===0&&S>0&&s>0&&(c=Math.ceil(s/S)),S===0&&(S=1),c===0&&(c=1),U(y,S,c,x)},[o,d,m,s]);return{areasTemplate:o,trackColumnCount:d,trackRowCount:m,applyMatrixToStore:f,clearAreasInStore:k,seedFromStore:T}}var ue=g(E()),ae=g(A()),Tr=g(M());var pe=g(A()),le=g(E());var de=g(A()),me=g(M());var fe=g(A()),ge=g(M()),ye=g(E());var Pr=Object.freeze({});var Dt=g(A()),xe=g(vt());function Se(e){let{areasTemplate:t,trackColumnCount:r,trackRowCount:s,applyMatrixToStore:n,clearAreasInStore:a,seedFromStore:u}=ot(e),o=(0,R.useMemo)(()=>{let c=u(".");return console.log("[areas seed -> shape]",c.length,c[0]?.length),c},[u]),d=(0,R.useMemo)(()=>({count:o?.[0]?.length||b(r)}),[o,r]),m=(0,R.useMemo)(()=>({count:o?.length||b(s)}),[o,s]),f=(0,R.useCallback)(c=>{let p=c[0]?.length||0,i=c.length||0,l=U(c.map(h=>h.map(I=>String(I??"").trim()||".")),p,i,".");n(l)},[n]),k=(0,R.useMemo)(()=>{let c=o?.length||0,p=c&&o[0]?.length||0;return{rows:c,cols:p}},[o]),T=(0,R.useCallback)((c,p)=>c>=0&&c<k.cols&&p>=0&&p<k.rows,[k]),x=(0,R.useCallback)((c,p,i)=>{if(!Array.isArray(o)||o.length===0)return;let l=Math.trunc(b(c))||0,h=Math.trunc(b(p))||0;if(!T(l,h))return;let I=String(i??"").trim()||".",H=o.map($t=>$t.slice());H[h][l]=I,f(H)},[o,f,T]),y=(0,R.useCallback)(({rows:c,cols:p})=>{let i=b(c),l=b(p);if(!(i>0&&l>0))return;let h=U(o,l,i,".");f(h)},[o,f]),S=(0,R.useCallback)(()=>a(),[a]);return{matrix:o,columnData:d,rowData:m,setCell:x,resize:y,clear:S}}})();
